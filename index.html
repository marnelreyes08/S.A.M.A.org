<!DOCTYPE html>
<!--
    FILIPINO CLUB WEBSITE - CLOUD-SYNCED VERSION
    
    DEFAULT PASSWORD: Filipino2026!
    
    HOW TO USE:
    1. Open this website URL (hosted on Vercel)
    2. Click "EDIT MODE" button (top right)
    3. Enter the password when prompted
    4. Make your edits - they save to the cloud automatically!
    5. Anyone who opens the website will see your updates
    
    FEATURES:
    - Edit text by clicking on it
    - Upload background images for any section
    - Upload board member photos
    - Add/delete events, board members, and custom sections
    - Edit social media links
    - All changes sync across all devices in real-time!
    
    HOSTING:
    - Hosted on Vercel
    - Database on Supabase
    - Changes are permanent and visible to everyone
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filipino Club</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Karla:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary: #0038A8;
            --secondary: #CE1126;
            --yellow: #FCD116;
            --cream: #FFF8E7;
            --dark: #1a1a2e;
            --text: #2d2d2d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Karla', sans-serif;
            background: var(--cream);
            color: var(--text);
            overflow-x: hidden;
        }
        
        /* Loading spinner */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            transition: opacity 0.5s ease;
        }
        
        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--yellow);
            border-top: 5px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Edit Mode Styles */
        .edit-mode-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--secondary);
            color: white;
            padding: 12px 20px;
            z-index: 10000;
            display: none;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .edit-mode-banner.active {
            display: flex;
        }
        
        .edit-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 16px;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0,56,168,0.3);
            transition: all 0.3s ease;
        }
        
        .edit-toggle:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(206,17,38,0.4);
        }
        
        [contenteditable="true"] {
            outline: 2px dashed var(--yellow);
            outline-offset: 4px;
            cursor: text;
            transition: outline 0.2s ease;
        }
        
        [contenteditable="true"]:focus {
            outline: 3px solid var(--secondary);
        }
        
        /* Hero Section */
        .hero {
            min-height: 100vh;
            background: linear-gradient(135deg, rgba(0, 56, 168, 0.85) 0%, rgba(0, 45, 135, 0.9) 100%),
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600"><defs><pattern id="stars" x="0" y="0" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="20" cy="20" r="2" fill="%23FCD116" opacity="0.3"/><circle cx="60" cy="40" r="1.5" fill="%23FCD116" opacity="0.4"/><circle cx="80" cy="70" r="1" fill="%23FCD116" opacity="0.5"/></pattern></defs><rect width="1200" height="600" fill="url(%23stars)"/></svg>');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 35px,
                    rgba(252, 209, 22, 0.03) 35px,
                    rgba(252, 209, 22, 0.03) 70px
                );
            animation: slide 20s linear infinite;
        }
        
        @keyframes slide {
            0% { transform: translateX(0); }
            100% { transform: translateX(70px); }
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            max-width: 900px;
        }
        
        .hero h1 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(3rem, 10vw, 8rem);
            color: white;
            letter-spacing: 8px;
            margin-bottom: 20px;
            text-shadow: 4px 4px 0 var(--secondary);
            animation: fadeInUp 1s ease;
        }
        
        .tagline {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            color: var(--yellow);
            font-weight: 300;
            letter-spacing: 2px;
            animation: fadeInUp 1s ease 0.3s backwards;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* About Section */
        .about {
            padding: 100px 20px;
            background: var(--cream);
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(206, 17, 38, 0.02) 10px, rgba(206, 17, 38, 0.02) 20px),
                repeating-linear-gradient(-45deg, transparent, transparent 10px, rgba(0, 56, 168, 0.02) 10px, rgba(0, 56, 168, 0.02) 20px);
            position: relative;
        }
        
        .about::before {
            content: '';
            position: absolute;
            top: -50px;
            left: 0;
            right: 0;
            height: 100px;
            background: var(--cream);
            clip-path: polygon(0 50%, 100% 0, 100% 100%, 0 100%);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .section-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: clamp(2.5rem, 5vw, 4rem);
            color: var(--primary);
            letter-spacing: 4px;
            margin-bottom: 40px;
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 60%;
            height: 4px;
            background: var(--secondary);
        }
        
        .about-text {
            font-size: 1.2rem;
            line-height: 1.8;
            max-width: 800px;
            margin-bottom: 30px;
            font-weight: 300;
        }
        
        /* Mission/Vision Grid */
        .mission-vision {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }
        
        .card {
            background: white;
            padding: 40px;
            border-radius: 0;
            box-shadow: 8px 8px 0 var(--yellow);
            border: 3px solid var(--primary);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translate(-4px, -4px);
            box-shadow: 12px 12px 0 var(--yellow);
        }
        
        .card h3 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2rem;
            color: var(--secondary);
            letter-spacing: 2px;
            margin-bottom: 20px;
        }
        
        .card p {
            line-height: 1.6;
            font-weight: 300;
        }
        
        /* Events Section */
        .events {
            padding: 100px 20px;
            background: linear-gradient(to bottom, var(--cream) 0%, white 100%);
        }
        
        .events-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 60px;
        }
        
        .event-card {
            background: var(--primary);
            color: white;
            padding: 30px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .event-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--yellow);
        }
        
        .event-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(0,56,168,0.3);
        }
        
        .event-card h4 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.8rem;
            letter-spacing: 2px;
            margin-bottom: 15px;
            color: var(--yellow);
        }
        
        .event-card .date {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .event-card p {
            line-height: 1.6;
            font-weight: 300;
        }
        
        /* Board Members Section */
        .board {
            padding: 100px 20px;
            background: var(--dark);
            color: white;
        }
        
        .board .section-title {
            color: var(--yellow);
        }
        
        .board-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }
        
        .board-member {
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .board-member:hover {
            transform: scale(1.05);
        }
        
        .member-photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--primary);
            margin: 0 auto 20px;
            border: 4px solid var(--yellow);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 3rem;
            color: white;
            position: relative;
            overflow: hidden;
            background-size: cover;
            background-position: center;
        }
        
        .member-photo-upload {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(206, 17, 38, 0.95);
            color: white;
            padding: 8px;
            font-size: 0.7rem;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 1px;
        }
        
        .board-member:hover .member-photo-upload {
            opacity: 1;
        }
        
        .board-member h4 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            letter-spacing: 1px;
            margin-bottom: 5px;
            color: var(--yellow);
        }
        
        .board-member .position {
            color: var(--cream);
            font-weight: 300;
            margin-bottom: 10px;
        }
        
        .board-member .email {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* Contact Section */
        .contact {
            padding: 100px 20px;
            background: var(--cream);
            text-align: center;
        }
        
        .contact-info {
            max-width: 600px;
            margin: 40px auto;
            font-size: 1.2rem;
            line-height: 2;
        }
        
        .contact-info a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        
        .contact-info a:hover {
            color: var(--secondary);
        }
        
        .social-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 40px;
            flex-wrap: wrap;
        }
        
        .social-links a {
            width: 60px;
            height: 60px;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            border-radius: 50%;
        }
        
        .social-links a:hover {
            background: var(--secondary);
            transform: rotate(5deg) scale(1.1);
        }
        
        .social-links svg {
            transition: transform 0.3s ease;
        }
        
        .social-links a:hover svg {
            transform: scale(1.1);
        }
        
        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            text-align: center;
            padding: 30px 20px;
            font-weight: 300;
        }
        
        /* Save indicator */
        .save-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            opacity: 0;
            transition: opacity 0.3s ease;
            font-weight: 600;
            z-index: 9998;
        }
        
        .save-indicator.show {
            opacity: 1;
        }
        
        /* Background change button */
        .bg-change-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(206, 17, 38, 0.9);
            color: white;
            border: 2px solid white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 14px;
            letter-spacing: 1px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 100;
        }
        
        .bg-changeable:hover .bg-change-btn {
            opacity: 1;
        }
        
        /* Hero background button - always more visible */
        #section-hero .bg-change-btn {
            top: 80px;
            right: 30px;
            font-size: 16px;
            padding: 12px 24px;
            background: var(--yellow);
            color: var(--dark);
            border: 3px solid var(--dark);
            box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.3);
            opacity: 0.9;
        }
        
        #section-hero .bg-change-btn:hover {
            opacity: 1;
            transform: scale(1.05);
        }
        
        .bg-changeable {
            position: relative;
        }
        
        /* Add buttons */
        .add-btn {
            background: var(--yellow);
            color: var(--dark);
            border: 3px solid var(--dark);
            padding: 15px 30px;
            border-radius: 0;
            cursor: pointer;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.2rem;
            letter-spacing: 2px;
            margin: 20px auto;
            display: none;
            transition: all 0.3s ease;
            box-shadow: 4px 4px 0 var(--primary);
        }
        
        .add-btn:hover {
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0 var(--primary);
        }
        
        .add-btn.show {
            display: block;
        }
        
        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--secondary);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 50;
        }
        
        .deletable:hover .delete-btn {
            opacity: 1;
        }
        
        .deletable {
            position: relative;
        }
        
        /* New section styles */
        .custom-section {
            padding: 100px 20px;
            background: white;
            position: relative;
        }
        
        .section-controls {
            text-align: center;
            margin: 40px 0;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>
    
    <!-- Edit Mode Toggle -->
    <button class="edit-toggle" onclick="toggleEditMode()">EDIT MODE</button>
    
    <!-- Edit Mode Banner -->
    <div class="edit-mode-banner" id="editBanner">
        <div>
            <strong>‚úèÔ∏è Edit Mode Active</strong> - Click on any text to edit it. Changes save to cloud automatically!
        </div>
        <div style="display: flex; gap: 10px;">
            <button onclick="changePassword()" style="background: white; color: var(--dark); border: none; padding: 8px 20px; border-radius: 20px; cursor: pointer; font-weight: 600;">
                üîë Change Password
            </button>
        </div>
    </div>
    
    <!-- Save Indicator -->
    <div class="save-indicator" id="saveIndicator">‚úì Changes Saved!</div>
    
    <!-- Hidden file inputs -->
    <input type="file" id="bgImageInput" accept="image/*" style="display: none;">
    <input type="file" id="memberPhotoInput" accept="image/*" style="display: none;">
    
    <!-- Hero Section -->
    <section class="hero bg-changeable" id="section-hero">
        <button class="bg-change-btn" onclick="changeBackground('section-hero')" style="display: none;">üñºÔ∏è Change Hero Background</button>
        <div class="hero-content">
            <h1 class="editable" data-field="hero-title">FILIPINO CLUB</h1>
            <p class="tagline editable" data-field="hero-tagline">Celebrating culture, building community</p>
        </div>
    </section>
    
    <!-- About Section -->
    <section class="about bg-changeable" id="section-about">
        <button class="bg-change-btn" onclick="changeBackground('section-about')" style="display: none;">üñºÔ∏è Change Background</button>
        <div class="container">
            <h2 class="section-title editable" data-field="about-title">About Us</h2>
            <p class="about-text editable" data-field="about-text">
                Welcome to Filipino Club! We are a vibrant community dedicated to celebrating Filipino culture, 
                heritage, and traditions. Through cultural events, educational programs, and community service, 
                we create a welcoming space for everyone to learn about and appreciate the rich Filipino heritage.
            </p>
            
            <div class="mission-vision">
                <div class="card">
                    <h3 class="editable" data-field="mission-title">Our Mission</h3>
                    <p class="editable" data-field="mission-text">
                        To foster cultural awareness and pride in Filipino heritage while building lasting 
                        connections within our community through engaging programs and meaningful experiences.
                    </p>
                </div>
                <div class="card">
                    <h3 class="editable" data-field="vision-title">Our Vision</h3>
                    <p class="editable" data-field="vision-text">
                        A thriving community where Filipino culture is celebrated, preserved, and shared with 
                        future generations, creating bridges of understanding and appreciation.
                    </p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Events Section -->
    <section class="events bg-changeable" id="section-events">
        <button class="bg-change-btn" onclick="changeBackground('section-events')" style="display: none;">üñºÔ∏è Change Background</button>
        <div class="container">
            <h2 class="section-title editable" data-field="events-title">Upcoming Events</h2>
            
            <div class="events-grid" id="eventsGrid">
                <!-- Events will be loaded from database -->
            </div>
            
            <div class="section-controls">
                <button class="add-btn" id="addEventBtn" onclick="addEvent()">+ Add Event</button>
            </div>
        </div>
    </section>
    
    <!-- Board Members Section -->
    <section class="board bg-changeable" id="section-board">
        <button class="bg-change-btn" onclick="changeBackground('section-board')" style="display: none;">üñºÔ∏è Change Background</button>
        <div class="container">
            <h2 class="section-title editable" data-field="board-title">Board Members</h2>
            
            <div class="board-grid" id="boardGrid">
                <!-- Board members will be loaded from database -->
            </div>
            
            <div class="section-controls">
                <button class="add-btn" id="addBoardBtn" onclick="addBoardMember()">+ Add Board Member</button>
            </div>
        </div>
    </section>
    
    <!-- Contact Section -->
    <section class="contact bg-changeable" id="section-contact">
        <button class="bg-change-btn" onclick="changeBackground('section-contact')" style="display: none;">üñºÔ∏è Change Background</button>
        <div class="container">
            <h2 class="section-title editable" data-field="contact-title">Get In Touch</h2>
            <div class="contact-info">
                <p class="editable" data-field="contact-email">Email: <a href="mailto:info@filipinoclub.org">info@filipinoclub.org</a></p>
                <p class="editable" data-field="contact-text">Follow us on social media to stay updated!</p>
            </div>
            
            <div class="social-links" id="socialLinks">
                <!-- Social links will be loaded from database -->
            </div>
            
            <div class="section-controls" style="margin-top: 30px;">
                <button class="add-btn" id="editSocialBtn" onclick="editSocialLinks()" style="font-size: 1rem; padding: 12px 30px; background: var(--secondary); color: white; border-color: white;">üîó Edit Social Media Links</button>
            </div>
        </div>
    </section>
    
    <!-- Custom sections will be inserted here -->
    <div id="customSectionsContainer"></div>
    
    <!-- Add Section Button -->
    <div class="section-controls" style="background: var(--cream); padding: 40px 20px;">
        <button class="add-btn" id="addSectionBtn" onclick="addCustomSection()">+ Add New Section</button>
    </div>
    
    <!-- Footer -->
    <footer>
        <p class="editable" data-field="footer-text">¬© 2026 Filipino Club. All rights reserved. | Mabuhay! üáµüá≠</p>
    </footer>
    
    <script>
        // Supabase configuration
        const SUPABASE_URL = 'https://qivbayioflggugjyrsny.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFpdmJheWlvZmxnZ3Vnanlyc255Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4MzQzNDUsImV4cCI6MjA4NTQxMDM0NX0.-Tnqrtgo2VeJOt2Yzk13lBUt81gb0m-xjr2-wRFso_I';
        
        const { createClient } = window.supabase;
        const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);
        
        let editMode = false;
        let isAuthenticated = false;
        const DEFAULT_PASSWORD = 'Filipino2026!';
        
        // Load content on page load
        window.addEventListener('DOMContentLoaded', async () => {
            await loadFromDatabase();
            hideLoading();
        });
        
        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }
        
        async function loadFromDatabase() {
            try {
                const { data, error } = await supabase
                    .from('website_content')
                    .select('*')
                    .eq('content_type', 'main')
                    .single();
                
                if (error) throw error;
                
                if (data && data.content_data) {
                    const content = data.content_data;
                    
                    // Load text fields
                    if (content.text_fields) {
                        Object.keys(content.text_fields).forEach(field => {
                            const element = document.querySelector(`[data-field="${field}"]`);
                            if (element) {
                                element.innerHTML = content.text_fields[field];
                            }
                        });
                    }
                    
                    // Load events
                    if (content.events) {
                        renderEvents(content.events);
                    }
                    
                    // Load board members
                    if (content.board_members) {
                        renderBoardMembers(content.board_members);
                    }
                    
                    // Load social links
                    if (content.social_links) {
                        renderSocialLinks(content.social_links);
                    }
                    
                    // Load backgrounds
                    if (content.backgrounds) {
                        loadBackgrounds(content.backgrounds);
                    }
                    
                    // Load custom sections
                    if (content.custom_sections) {
                        renderCustomSections(content.custom_sections);
                    }
                    
                    // Load password
                    if (content.password) {
                        localStorage.setItem('filipinoclub_password', content.password);
                    }
                }
            } catch (error) {
                console.error('Error loading from database:', error);
            }
        }
        
        function renderEvents(events) {
            const grid = document.getElementById('eventsGrid');
            grid.innerHTML = events.map((event, index) => `
                <div class="event-card deletable" data-event-id="${index}">
                    <button class="delete-btn" onclick="deleteEvent(${index})" style="display: none;">‚úï</button>
                    <h4 class="editable" data-field="event-${index}-title">${event.title}</h4>
                    <p class="date editable" data-field="event-${index}-date">${event.date}</p>
                    <p class="editable" data-field="event-${index}-description">${event.description}</p>
                </div>
            `).join('');
        }
        
        function renderBoardMembers(members) {
            const grid = document.getElementById('boardGrid');
            grid.innerHTML = members.map((member, index) => `
                <div class="board-member deletable" data-member-id="${index}">
                    <button class="delete-btn" onclick="deleteBoardMember(${index})" style="display: none;">‚úï</button>
                    <div class="member-photo editable" id="member-photo-${index}" data-field="member-${index}-photo" style="${member.photo ? `background-image: url(${member.photo}); font-size: 0;` : ''}">
                        ${member.initials || 'AB'}
                        <div class="member-photo-upload" onclick="uploadMemberPhoto('member-photo-${index}', ${index})" style="display: none;">üì∑ Upload Photo</div>
                    </div>
                    <h4 class="editable" data-field="member-${index}-name">${member.name}</h4>
                    <p class="position editable" data-field="member-${index}-position">${member.position}</p>
                    <p class="email editable" data-field="member-${index}-email">${member.email}</p>
                </div>
            `).join('');
        }
        
        function renderSocialLinks(links) {
            const container = document.getElementById('socialLinks');
            const socialIcons = {
                facebook: '<path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>',
                instagram: '<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>',
                twitter: '<path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>'
            };
            
            container.innerHTML = links.map((link, index) => `
                <a href="${link.url}" class="deletable" id="social-${link.platform}-container" data-platform="${link.platform}" style="position: relative;">
                    <button class="delete-btn" onclick="deleteSocialLink(${index})" style="display: none; top: -5px; right: -5px;">‚úï</button>
                    <svg id="social-${link.platform}" xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="white">
                        ${socialIcons[link.platform] || ''}
                    </svg>
                </a>
            `).join('');
        }
        
        function renderCustomSections(sections) {
            const container = document.getElementById('customSectionsContainer');
            container.innerHTML = sections.map((section, index) => `
                <section class="custom-section bg-changeable deletable" id="${section.id}">
                    <button class="delete-btn" onclick="deleteCustomSection(${index})" style="top: 50px; right: 50px; font-size: 20px; padding: 10px 15px;">‚úï</button>
                    <button class="bg-change-btn" onclick="changeBackground('${section.id}')" style="display: none;">üñºÔ∏è Change Background</button>
                    <div class="container">
                        <h2 class="section-title editable" data-field="custom-${index}-title">${section.title}</h2>
                        <p class="about-text editable" data-field="custom-${index}-text">${section.text}</p>
                    </div>
                </section>
            `).join('');
        }
        
        function loadBackgrounds(backgrounds) {
            Object.keys(backgrounds).forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section && backgrounds[sectionId]) {
                    section.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${backgrounds[sectionId]})`;
                    section.style.backgroundSize = 'cover';
                    section.style.backgroundPosition = 'center';
                    section.style.backgroundAttachment = 'fixed';
                }
            });
        }
        
        async function saveToDatabase() {
            try {
                const content = {
                    text_fields: {},
                    events: [],
                    board_members: [],
                    social_links: [],
                    backgrounds: {},
                    custom_sections: [],
                    password: localStorage.getItem('filipinoclub_password') || DEFAULT_PASSWORD
                };
                
                // Collect text fields
                document.querySelectorAll('[data-field]').forEach(el => {
                    const field = el.getAttribute('data-field');
                    if (field && !field.includes('event-') && !field.includes('member-') && !field.includes('custom-')) {
                        content.text_fields[field] = el.innerHTML;
                    }
                });
                
                // Collect events
                document.querySelectorAll('[data-event-id]').forEach(eventEl => {
                    const id = eventEl.getAttribute('data-event-id');
                    content.events.push({
                        title: document.querySelector(`[data-field="event-${id}-title"]`)?.innerHTML || '',
                        date: document.querySelector(`[data-field="event-${id}-date"]`)?.innerHTML || '',
                        description: document.querySelector(`[data-field="event-${id}-description"]`)?.innerHTML || ''
                    });
                });
                
                // Collect board members
                document.querySelectorAll('[data-member-id]').forEach(memberEl => {
                    const id = memberEl.getAttribute('data-member-id');
                    const photoEl = document.getElementById(`member-photo-${id}`);
                    content.board_members.push({
                        initials: photoEl?.textContent?.trim() || 'AB',
                        photo: photoEl?.style?.backgroundImage ? photoEl.style.backgroundImage.replace(/url\(['"]?([^'"]+)['"]?\)/, '$1') : '',
                        name: document.querySelector(`[data-field="member-${id}-name"]`)?.innerHTML || '',
                        position: document.querySelector(`[data-field="member-${id}-position"]`)?.innerHTML || '',
                        email: document.querySelector(`[data-field="member-${id}-email"]`)?.innerHTML || ''
                    });
                });
                
                // Collect social links
                document.querySelectorAll('#socialLinks a').forEach(linkEl => {
                    const platform = linkEl.getAttribute('data-platform');
                    content.social_links.push({
                        platform: platform,
                        url: linkEl.href
                    });
                });
                
                // Collect backgrounds
                document.querySelectorAll('.bg-changeable').forEach(section => {
                    if (section.style.backgroundImage && section.id) {
                        const match = section.style.backgroundImage.match(/url\(['"]?([^'"]+)['"]?\)/);
                        if (match && match[1] && match[1].startsWith('data:')) {
                            content.backgrounds[section.id] = match[1];
                        }
                    }
                });
                
                // Collect custom sections
                document.querySelectorAll('#customSectionsContainer section').forEach((section, index) => {
                    content.custom_sections.push({
                        id: section.id,
                        title: document.querySelector(`[data-field="custom-${index}-title"]`)?.innerHTML || '',
                        text: document.querySelector(`[data-field="custom-${index}-text"]`)?.innerHTML || ''
                    });
                });
                
                // Save to Supabase
                const { error } = await supabase
                    .from('website_content')
                    .update({ content_data: content, updated_at: new Date() })
                    .eq('content_type', 'main');
                
                if (error) throw error;
                
                showSaveIndicator('‚úì Saved to Cloud!');
            } catch (error) {
                console.error('Error saving to database:', error);
                showSaveIndicator('‚úó Save failed!');
            }
        }
        
        function showSaveIndicator(message) {
            const indicator = document.getElementById('saveIndicator');
            indicator.textContent = message;
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }
        
        function toggleEditMode() {
            if (!editMode && !isAuthenticated) {
                const savedPassword = localStorage.getItem('filipinoclub_password') || DEFAULT_PASSWORD;
                const password = prompt('Enter board member password to access edit mode:');
                
                if (!password) return;
                
                if (password === savedPassword) {
                    isAuthenticated = true;
                    alert('‚úì Access granted! Your edits will save to the cloud automatically.');
                } else {
                    alert('‚úó Incorrect password. Access denied.');
                    return;
                }
            }
            
            editMode = !editMode;
            const editables = document.querySelectorAll('.editable');
            const banner = document.getElementById('editBanner');
            const button = document.querySelector('.edit-toggle');
            const bgButtons = document.querySelectorAll('.bg-change-btn');
            const addButtons = document.querySelectorAll('.add-btn');
            const deleteButtons = document.querySelectorAll('.delete-btn');
            const photoUploadButtons = document.querySelectorAll('.member-photo-upload');
            
            editables.forEach(el => {
                el.contentEditable = editMode;
                if (editMode) {
                    el.addEventListener('blur', saveToDatabase);
                } else {
                    el.removeEventListener('blur', saveToDatabase);
                }
            });
            
            bgButtons.forEach(btn => btn.style.display = editMode ? 'block' : 'none');
            addButtons.forEach(btn => editMode ? btn.classList.add('show') : btn.classList.remove('show'));
            deleteButtons.forEach(btn => btn.style.display = editMode ? 'block' : 'none');
            photoUploadButtons.forEach(btn => btn.style.display = editMode ? 'block' : 'none');
            
            if (editMode) {
                banner.classList.add('active');
                button.textContent = 'EXIT EDIT MODE';
                button.style.background = 'var(--secondary)';
            } else {
                banner.classList.remove('active');
                button.textContent = 'EDIT MODE';
                button.style.background = 'var(--primary)';
                isAuthenticated = false;
            }
        }
        
        async function changePassword() {
            const currentPassword = localStorage.getItem('filipinoclub_password') || DEFAULT_PASSWORD;
            const oldPassword = prompt('Enter current password:');
            
            if (oldPassword !== currentPassword) {
                alert('‚úó Incorrect current password!');
                return;
            }
            
            const newPassword = prompt('Enter new password (min 8 characters):');
            
            if (!newPassword || newPassword.length < 8) {
                alert('‚úó Password must be at least 8 characters long!');
                return;
            }
            
            const confirmPassword = prompt('Confirm new password:');
            
            if (newPassword !== confirmPassword) {
                alert('‚úó Passwords do not match!');
                return;
            }
            
            localStorage.setItem('filipinoclub_password', newPassword);
            await saveToDatabase();
            alert('‚úì Password changed successfully! Please remember your new password.');
        }
        
        function changeBackground(sectionId) {
            const input = document.getElementById('bgImageInput');
            
            input.onchange = async function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = async function(event) {
                    const section = document.getElementById(sectionId);
                    const imageData = event.target.result;
                    
                    section.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${imageData})`;
                    section.style.backgroundSize = 'cover';
                    section.style.backgroundPosition = 'center';
                    section.style.backgroundAttachment = 'fixed';
                    
                    await saveToDatabase();
                    showSaveIndicator('‚úì Background Saved!');
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }
        
        function uploadMemberPhoto(photoId, memberId) {
            const input = document.getElementById('memberPhotoInput');
            
            input.onchange = async function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = async function(event) {
                    const photoElement = document.getElementById(photoId);
                    const imageData = event.target.result;
                    
                    photoElement.style.backgroundImage = `url(${imageData})`;
                    photoElement.style.fontSize = '0';
                    
                    await saveToDatabase();
                    showSaveIndicator('‚úì Photo Uploaded!');
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }
        
        async function addEvent() {
            const grid = document.getElementById('eventsGrid');
            const index = document.querySelectorAll('[data-event-id]').length;
            
            const newEvent = document.createElement('div');
            newEvent.className = 'event-card deletable';
            newEvent.setAttribute('data-event-id', index);
            newEvent.innerHTML = `
                <button class="delete-btn" onclick="deleteEvent(${index})">‚úï</button>
                <h4 class="editable" data-field="event-${index}-title" contenteditable="true">New Event</h4>
                <p class="date editable" data-field="event-${index}-date" contenteditable="true">Date ‚Ä¢ Time</p>
                <p class="editable" data-field="event-${index}-description" contenteditable="true">Click to add event description...</p>
            `;
            grid.appendChild(newEvent);
            
            newEvent.querySelectorAll('.editable').forEach(el => {
                el.addEventListener('blur', saveToDatabase);
            });
            
            await saveToDatabase();
        }
        
        async function deleteEvent(index) {
            if (confirm('Are you sure you want to delete this event?')) {
                const eventEl = document.querySelector(`[data-event-id="${index}"]`);
                eventEl.remove();
                await saveToDatabase();
            }
        }
        
        async function addBoardMember() {
            const grid = document.getElementById('boardGrid');
            const index = document.querySelectorAll('[data-member-id]').length;
            
            const newMember = document.createElement('div');
            const photoId = `member-photo-${index}`;
            newMember.className = 'board-member deletable';
            newMember.setAttribute('data-member-id', index);
            newMember.innerHTML = `
                <button class="delete-btn" onclick="deleteBoardMember(${index})">‚úï</button>
                <div class="member-photo editable" id="${photoId}" data-field="member-${index}-photo" contenteditable="true">
                    AB
                    <div class="member-photo-upload" onclick="uploadMemberPhoto('${photoId}', ${index})">üì∑ Upload Photo</div>
                </div>
                <h4 class="editable" data-field="member-${index}-name" contenteditable="true">Name</h4>
                <p class="position editable" data-field="member-${index}-position" contenteditable="true">Position</p>
                <p class="email editable" data-field="member-${index}-email" contenteditable="true">email@filipinoclub.org</p>
            `;
            grid.appendChild(newMember);
            
            newMember.querySelectorAll('.editable').forEach(el => {
                el.addEventListener('blur', saveToDatabase);
            });
            
            await saveToDatabase();
        }
        
        async function deleteBoardMember(index) {
            if (confirm('Are you sure you want to delete this board member?')) {
                const memberEl = document.querySelector(`[data-member-id="${index}"]`);
                memberEl.remove();
                await saveToDatabase();
            }
        }
        
        async function addCustomSection() {
            const container = document.getElementById('customSectionsContainer');
            const index = document.querySelectorAll('#customSectionsContainer section').length;
            const sectionId = 'custom-section-' + Date.now();
            
            const newSection = document.createElement('section');
            newSection.className = 'custom-section bg-changeable deletable';
            newSection.id = sectionId;
            newSection.innerHTML = `
                <button class="delete-btn" onclick="deleteCustomSection(${index})" style="top: 50px; right: 50px; font-size: 20px; padding: 10px 15px;">‚úï</button>
                <button class="bg-change-btn" onclick="changeBackground('${sectionId}')">üñºÔ∏è Change Background</button>
                <div class="container">
                    <h2 class="section-title editable" data-field="custom-${index}-title" contenteditable="true">New Section Title</h2>
                    <p class="about-text editable" data-field="custom-${index}-text" contenteditable="true">
                        Click to edit this section. Add your content here!
                    </p>
                </div>
            `;
            container.appendChild(newSection);
            
            newSection.querySelectorAll('.editable').forEach(el => {
                el.addEventListener('blur', saveToDatabase);
            });
            
            await saveToDatabase();
        }
        
        async function deleteCustomSection(index) {
            if (confirm('Are you sure you want to delete this section?')) {
                const sections = document.querySelectorAll('#customSectionsContainer section');
                sections[index].remove();
                await saveToDatabase();
            }
        }
        
        async function editSocialLinks() {
            const container = document.getElementById('socialLinks');
            const currentLinks = Array.from(container.querySelectorAll('a')).map(a => ({
                platform: a.getAttribute('data-platform'),
                url: a.href
            }));
            
            const platforms = ['facebook', 'instagram', 'twitter'];
            const newLinks = [];
            
            for (const platform of platforms) {
                const current = currentLinks.find(l => l.platform === platform);
                const url = prompt(`Enter ${platform.charAt(0).toUpperCase() + platform.slice(1)} URL (leave blank to skip):`, current?.url || '');
                if (url && url !== '#') {
                    newLinks.push({ platform, url });
                }
            }
            
            renderSocialLinks(newLinks);
            await saveToDatabase();
            showSaveIndicator('‚úì Social Links Updated!');
        }
        
        async function deleteSocialLink(index) {
            if (confirm('Are you sure you want to delete this social media link?')) {
                const links = Array.from(document.querySelectorAll('#socialLinks a')).map(a => ({
                    platform: a.getAttribute('data-platform'),
                    url: a.href
                }));
                links.splice(index, 1);
                renderSocialLinks(links);
                await saveToDatabase();
            }
        }
    </script>
</body>
</html>
